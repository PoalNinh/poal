<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Màn hình khách hàng - Goal Coffee</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #000;
            color: #fff;
            overflow: hidden;
        }
        .scroll-container {
            animation: scroll 20s linear infinite;
        }
        @keyframes scroll {
            0% { transform: translateY(0); }
            100% { transform: translateY(-50%); }
        }
        .item-enter {
            animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="h-screen flex flex-col">
        <!-- Header -->
        <div class="bg-blue-600 p-4">
            <div class="text-center">
                <h1 class="text-3xl font-bold">Goal Coffee</h1>
                <p class="text-lg mt-2" id="welcomeMessage">Xin chào quý khách!</p>
                <p class="text-xl mt-2" id="currentTime"></p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 flex">
            <!-- Cart Items -->
            <div class="w-2/3 p-4 border-r border-gray-700">
                <h2 class="text-xl font-semibold mb-4">Đơn hàng hiện tại</h2>
                <div id="cartItems" class="space-y-2">
                    <!-- Cart items will be displayed here -->
                </div>
            </div>

            <!-- Total and Promotions -->
            <div class="w-1/3 p-4 flex flex-col">
                <!-- Order Summary -->
                <div class="mb-6">
                    <h2 class="text-xl font-semibold mb-4">Tổng cộng</h2>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span>Tổng tiền hàng:</span>
                            <span id="subtotal">0đ</span>
                        </div>
                        <div class="flex justify-between">
                            <span>VAT (10%):</span>
                            <span id="vat">0đ</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Giảm giá:</span>
                            <span id="discount">0đ</span>
                        </div>
                        <div class="flex justify-between text-xl font-bold">
                            <span>Tổng cộng:</span>
                            <span id="total">0đ</span>
                        </div>
                    </div>
                </div>

                <!-- Promotions -->
                <div class="flex-1">
                    <h2 class="text-xl font-semibold mb-4">Khuyến mãi</h2>
                    <div id="promotions" class="h-48 overflow-hidden relative">
                        <div class="scroll-container">
                            <div class="p-2 bg-blue-900 rounded mb-2">🎉 Giảm 10% cho hóa đơn trên 500,000đ</div>
                            <div class="p-2 bg-blue-900 rounded mb-2">☕ Tặng 1 phần bánh cho hóa đơn trên 300,000đ</div>
                            <div class="p-2 bg-blue-900 rounded mb-2">🎁 Tích điểm đổi quà hấp dẫn</div>
                            <!-- Duplicate for smooth scrolling -->
                            <div class="p-2 bg-blue-900 rounded mb-2">🎉 Giảm 10% cho hóa đơn trên 500,000đ</div>
                            <div class="p-2 bg-blue-900 rounded mb-2">☕ Tặng 1 phần bánh cho hóa đơn trên 300,000đ</div>
                            <div class="p-2 bg-blue-900 rounded mb-2">🎁 Tích điểm đổi quà hấp dẫn</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Update current time
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('vi-VN');
            const dateString = now.toLocaleDateString('vi-VN');
            document.getElementById('currentTime').textContent = `${dateString} ${timeString}`;
        }
        setInterval(updateTime, 1000);
        updateTime();

        // Listen for messages from the main window
        window.addEventListener('message', function(event) {
            // Verify origin for security
            if (event.origin !== window.origin) return;

            const data = event.data;
            switch (data.type) {
                case 'updateCart':
                    updateCartDisplay(data.cart);
                    updateTotals(data.totals);
                    break;
                case 'welcome':
                    updateWelcomeMessage(data.customer);
                    break;
            }
        });

        function updateCartDisplay(cart) {
            const cartContainer = document.getElementById('cartItems');
            cartContainer.innerHTML = cart.map(item => `
                <div class="item-enter bg-gray-800 p-3 rounded-lg flex justify-between items-center">
                    <div>
                        <span class="font-medium">${item.name}</span>
                        <span class="text-gray-400"> x ${item.quantity}</span>
                    </div>
                    <span class="font-medium">${formatCurrency(item.price * item.quantity)}</span>
                </div>
            `).join('');
        }

        function updateTotals(totals) {
            document.getElementById('subtotal').textContent = formatCurrency(totals.subtotal);
            document.getElementById('vat').textContent = formatCurrency(totals.vat);
            document.getElementById('discount').textContent = formatCurrency(totals.discount);
            document.getElementById('total').textContent = formatCurrency(totals.total);
        }

        function updateWelcomeMessage(customer) {
            const message = customer ? `Xin chào, ${customer}!` : 'Xin chào quý khách!';
            document.getElementById('welcomeMessage').textContent = message;
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);
        }
    </script>
</body>
</html>
